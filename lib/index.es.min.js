import n,{Component as t}from"react";import e,{keyframes as r}from"styled-components";function o(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function")}function i(n,t){for(var e=0;e<t.length;e++){var r=t[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(n,r.key,r)}}function a(n,t,e){return t&&i(n.prototype,t),e&&i(n,e),n}function s(n,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");n.prototype=Object.create(t&&t.prototype,{constructor:{value:n,writable:!0,configurable:!0}}),t&&c(n,t)}function l(n){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(n){return n.__proto__||Object.getPrototypeOf(n)})(n)}function c(n,t){return(c=Object.setPrototypeOf||function(n,t){return n.__proto__=t,n})(n,t)}function u(n){if(void 0===n)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return n}function f(n,t){return!t||"object"!=typeof t&&"function"!=typeof t?u(n):t}function p(n,t){return t||(t=n.slice(0)),Object.freeze(Object.defineProperties(n,{raw:{value:Object.freeze(t)}}))}function h(n,t){return function(n){if(Array.isArray(n))return n}(n)||function(n,t){var e=[],r=!0,o=!1,i=void 0;try{for(var a,s=n[Symbol.iterator]();!(r=(a=s.next()).done)&&(e.push(a.value),!t||e.length!==t);r=!0);}catch(n){o=!0,i=n}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return e}(n,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function v(n){return function(n){if(Array.isArray(n)){for(var t=0,e=new Array(n.length);t<n.length;t++)e[t]=n[t];return e}}(n)||function(n){if(Symbol.iterator in Object(n)||"[object Arguments]"===Object.prototype.toString.call(n))return Array.from(n)}(n)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var d="#00A6ED",g="4px",y="8px",m="16px",x="32px";function b(){var n=p(["\n  0% {\n    transform: translate(50%, 0);\n  }\n  100% {\n    transform: translate(50%,-",");\n  }\n"]);return b=function(){return n},n}var k=r(b(),y);function w(n){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2,e=(n=n.toFixed(t)+"").split("."),r=e[0],o=e.length>1?"."+e[1]:"",i=/(\d+)(\d{3})/;i.test(r);)r=r.replace(i,"$1,$2");return r+o}var E=function(){function n(){o(this,n)}return a(n,null,[{key:"hslToRgb",value:function(n,t,e){var r,o,i;if(0===t)r=o=i=e;else{var a=function(n,t,e){return e<0&&(e+=1),e>1&&(e-=1),e<1/6?n+6*(t-n)*e:e<.5?t:e<2/3?n+(t-n)*(2/3-e)*6:n},s=e<.5?e*(1+t):e+t-e*t,l=2*e-s;r=a(l,s,n+1/3),o=a(l,s,n),i=a(l,s,n-1/3)}return[Math.round(255*r),Math.round(255*o),Math.round(255*i)]}},{key:"rgbToHsl",value:function(n,t,e){n/=255,t/=255,e/=255;var r,o,i=Math.max(n,t,e),a=Math.min(n,t,e),s=(i+a)/2;if(i===a)r=o=0;else{var l=i-a;switch(o=s>.5?l/(2-i-a):l/(i+a),i){case n:r=(t-e)/l+(t<e?6:0);break;case t:r=(e-n)/l+2;break;case e:r=(n-t)/l+4}r/=6}return[r,o,s]}},{key:"lightenColor",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.5;if(t&&t.length>=6){var r=parseInt(t.slice(-6,-4),16),o=parseInt(t.slice(-4,-2),16),i=parseInt(t.slice(-2),16),a=n.rgbToHsl(r,o,i);a[2]=Math.min(a[2]+e,1);var s=n.hslToRgb(a[0],a[1],a[2]);return"#"+s[0].toString(16)+s[1].toString(16)+s[2].toString(16)}return null}},{key:"darkenColor",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.1;if(t&&t.length>=6){var r=parseInt(t.slice(-6,-4),16),o=parseInt(t.slice(-4,-2),16),i=parseInt(t.slice(-2),16),a=n.rgbToHsl(r,o,i);a[2]=Math.max(a[2]-e,0);var s=n.hslToRgb(a[0],a[1],a[2]),l=s[0].toString(16).length<2?"0"+s[0].toString(16):s[0].toString(16),c=s[1].toString(16).length<2?"0"+s[1].toString(16):s[1].toString(16),u=s[2].toString(16).length<2?"0"+s[2].toString(16):s[2].toString(16);return"#".concat(l).concat(c).concat(u)}return null}},{key:"getBlackOrWhiteContrastColor",value:function(n){if(n&&n.length>=6)return.2126*parseInt(n.slice(-6,-4),16)+.7152*parseInt(n.slice(-4,-2),16)+.0722*parseInt(n.slice(-2),16)<180?"#FFFFFF":"#000000"}}]),n}();function M(){var n=p(["\n          vector-effect: non-scaling-stroke;\n          pointer-events : none;\n          fill : none;\n          stroke: ",";\n          stroke-width: 2;\n        "]);return M=function(){return n},n}function S(){var n=p(["\n          vector-effect: non-scaling-stroke;\n          pointer-events : none;\n          fill : ",";\n          stroke: ",";\n          opacity: 0.2;\n          stroke-width: 2;\n        "]);return S=function(){return n},n}function P(){var n=p(["\n          display: inline-block;\n          font-size : 12px;\n          color : ",";\n          font-family : sans-serif;\n          font-weight: lighter;\n          position: absolute;\n          top: 12px;\n          transform: translate(50%,-",");\n          background: ",";\n          padding: "," ",";\n          border-radius: ",";\n          opacity: 0;\n          transition: opacity 200ms;\n          \n          animation: "," 200ms ease-out;\n          \n          &:not(:empty) {\n            opacity: 1;\n            \n            &:after {\n                content: '';\n                position: absolute;\n                top: 100%;\n                left: 50%;\n                border-left: 4px solid transparent;\n                border-right: 4px solid transparent;\n                border-top: 4px solid",";\n                transform: translate(-50%, 0);\n            }\n          }\n        "]);return P=function(){return n},n}function C(){var n=p(["\n          top: 12px;\n          left: 0;\n          position: absolute;\n          color : ",";\n          font-family : sans-serif;\n          font-size : 12px;\n          font-weight: lighter;\n          text-align: center;\n          min-width: 100px;\n          transform:translate(-50%,0);\n        \n          ",":last-child & {\n            text-align: right;\n            transform:translate(-100%,0);\n          }\n        \n          ",":first-child & {\n            text-align: left;\n            transform:translate(0,0);\n          }\n        "]);return C=function(){return n},n}function A(){var n=p(["\n          flex: 1 1 auto;\n          border-left : 2px solid ","; \n          pointer-events : none;\n          overflow: visible;\n          position: relative;\n          height: 10px;\n          \n          &:last-child {\n            width: 0;\n            flex: 0 0 0; \n          }\n        "]);return A=function(){return n},n}function F(){var n=p(["\n          display: flex;\n          flex-flow: row nowrap;\n          border-top : 2px solid ","; \n        "]);return F=function(){return n},n}function O(){var n=p(["\n          stroke-width : 0;\n          stroke: transparent;\n          pointer-events : none;\n          vector-effect: non-scaling-stroke;\n          transition: stroke-width 100ms;\n          \n          ",":hover ~ & {\n          stroke-width : 2px;\n            stroke: ","; \n          }\n        "]);return O=function(){return n},n}function V(){var n=p(["\n          stroke-width : 2px;\n          stroke: ",";\n          opacity: 0.2;\n          vector-effect: non-scaling-stroke;\n          pointer-events : none;\n        "]);return V=function(){return n},n}function j(){var n=p(["\n          stroke-width : 0;\n          stroke: ",";\n          transition: stroke-width 300ms, stroke 300ms;\n          pointer-events : none;\n          vector-effect: non-scaling-stroke;\n          stroke-linecap: round;\n           \n          ",":hover ~ & {\n            stroke-width : 6px; \n          }\n        "]);return j=function(){return n},n}function I(){var n=p(["\n          stroke-width : 6px;\n          stroke: ",";\n          transition: stroke-width 300ms;\n          pointer-events : none;\n          vector-effect: non-scaling-stroke;\n          stroke-linecap: round;\n           \n          ",":hover ~ & {\n            stroke-width : 10px; \n          }\n        "]);return I=function(){return n},n}function z(){var n=p(["\n          fill: transparent;\n          vector-effect: non-scaling-stroke;\n        "]);return z=function(){return n},n}function T(){var n=p(["\n            display : block;\n            overflow: visible;\n            height: 150px;\n            width: 100%;\n            position: relative;\n        "]);return T=function(){return n},n}function _(){var n=p(["\n            display: block;\n            padding: "," 0 0 0;\n            position: relative;\n        "]);return _=function(){return n},n}var L=function(r){function i(n){var t;return o(this,i),(t=f(this,l(i).call(this,n))).formatValuesForLine=t.formatValuesForLine.bind(u(t)),t.lineStrategy=t.lineStrategy.bind(u(t)),t.bezierStrategy=t.bezierStrategy.bind(u(t)),t.controlPoint=t.controlPoint.bind(u(t)),t.line=t.line.bind(u(t)),t.formatCoordinatesAsPair=t.formatCoordinatesAsPair.bind(u(t)),t.showValue=t.showValue.bind(u(t)),t.decimals=t.props.decimals?t.props.decimals:0,t.state={shownValue:0,shownPosition:1},t}return s(i,t),a(i,[{key:"render",value:function(){var t=this;if(!this.props.values)return null;var r=this.props.color?this.props.color:d,o=E.darkenColor(r,.2),i=E.lightenColor(r,.1),a=E.getBlackOrWhiteContrastColor(r),s=e.div(_(),x),l=e.svg(T()),c=e.rect(z()),u=e.line(I(),r,c),f=e.line(j(),i,c),p=e.line(V(),r),h=e.line(O(),c,r),m=e.div(F(),o),b=e.div(A(),o),L=e.div(C(),o,b,b),R=e.span(P(),a,y,r,g,y,g,k,r),B=e.path(S(),r,r),H=e.path(M(),r),D=Math.max.apply(Math,v(this.props.values)),W=this.props.rounded?this.bezierStrategy:this.lineStrategy,$=this.formatValuesForLine(W),q=this.formatValuesForFill(W),G=this.formatCoordinatesAsPair(),J=110/G.length,K=this.formatCoordinatesForAxis();return n.createElement(s,null,n.createElement(l,{preserveAspectRatio:"none",viewBox:"0 0 100 "+D},n.createElement(H,{d:$}),n.createElement(B,{d:q}),G.map(function(e){var r=e[0],o=e[1];return n.createElement("g",{key:r},n.createElement(c,{x:r-J/2,y:0,width:.8*J,height:D,onMouseEnter:function(){t.showValue(D-o,r)},onMouseLeave:function(){t.showValue(null,null)}}),n.createElement(h,{x1:r,y1:o,x2:r,y2:D}),n.createElement(p,{x1:r,y1:o,x2:r,y2:0}),n.createElement(u,{x1:r,y1:o,x2:r,y2:o}),n.createElement(f,{x1:r,y1:o,x2:r,y2:o}))})),K.length?n.createElement(m,null,K.map(function(t){return n.createElement(b,{key:t.x},n.createElement(L,null,t.label))})):null,null!==this.state.shownValue?n.createElement(R,{style:{right:this.state.shownPosition+"%"}},this.props.prefix," ",w(this.state.shownValue,this.decimals)," ",this.props.postfix):null)}},{key:"showValue",value:function(n,t){this.setState({shownValue:n,shownPosition:100-t})}},{key:"formatCoordinatesAsPair",value:function(){if(this.props.values.length<2)return[];for(var n=[],t=Math.max.apply(Math,[0].concat(v(this.props.values))),e=100/(this.props.values.length-1),r=0;r<this.props.values.length;r++)n.push([r*e,Math.min(t,t-this.props.values[r])]);return n}},{key:"formatCoordinatesForAxis",value:function(){if(!this.props.axis)return[];for(var n=[],t=100/(this.props.axis.length-1),e=0;e<this.props.axis.length;e++)n.push({x:e*t,label:this.props.axis[e]});return n}},{key:"formatValuesForLine",value:function(n){return this.formatCoordinatesAsPair().reduce(function(t,e,r,o){return 0===r?"M ".concat(e[0],",").concat(e[1]):"".concat(t," ").concat(n(e,r,o))},"")}},{key:"formatValuesForFill",value:function(n){var t=this,e=this.formatCoordinatesAsPair(),r=[[0,Math.max.apply(Math,v(this.props.values))]].concat(v(e),[[100,Math.max.apply(Math,v(this.props.values))]]);return r.reduce(function(e,o,i,a){return 0===i?"M ".concat(o[0],",").concat(o[1]):1===i||i===r.length-1?"".concat(e," ").concat(t.lineStrategy(o)):"".concat(e," ").concat(n(o,i,a))},"")}},{key:"lineStrategy",value:function(n){return"L ".concat(n[0]," ").concat(n[1])}},{key:"bezierStrategy",value:function(n,t,e){var r=h(this.controlPoint(e[t-1],e[t-2],n),2),o=r[0],i=r[1],a=h(this.controlPoint(n,e[t-1],e[t+1],!0),2),s=a[0],l=a[1];return"C ".concat(o,",").concat(i," ").concat(s,",").concat(l," ").concat(n[0],",").concat(n[1])}},{key:"line",value:function(n,t){var e=t[0]-n[0],r=t[1]-n[1];return{length:Math.sqrt(Math.pow(e,2)+Math.pow(r,2)),angle:Math.atan2(r,e)}}},{key:"controlPoint",value:function(n,t,e,r){var o=t||n,i=e||n,a=this.line(o,i),s=a.angle+(r?Math.PI:0),l=.15*a.length;return[n[0]+Math.cos(s)*l,n[1]+Math.sin(s)*l]}}]),i}();function R(){var n=p(["\n            stroke-width: 2px;\n            fill: none;\n            stroke: ",";\n            opacity: 0.2;\n        "]);return R=function(){return n},n}function B(){var n=p(["\n            display : block;\n            height: 150px;\n            width: 150px;\n        "]);return B=function(){return n},n}function H(){var n=p(["\n            font-size: ",";\n            color: ",";\n            font-family : sans-serif;\n        "]);return H=function(){return n},n}function D(){var n=p(["\n            position: absolute;\n            display : block;\n            text-align: center;\n            top: 80px;\n            font-size: ",";\n            color: ",";\n            font-family : sans-serif;\n            width: 150px;\n        "]);return D=function(){return n},n}function W(){var n=p(["\n            position: absolute;\n            display : block;\n            text-align: center;\n            top: 40px;\n            font-size: ",";\n            color: ",";\n            font-family : sans-serif;\n            width: 150px;\n        "]);return W=function(){return n},n}function $(){var n=p(["\n            display : block;\n            position: relative;\n            height: 150px;\n            width: 150px;\n        "]);return $=function(){return n},n}function q(){var n=p(["\n            stroke-width: 2px;\n            fill: none;\n            stroke: ",";\n            //stroke-linecap: round;\n            transform: rotate(-90deg);\n            transform-origin: center;\n        "]);return q=function(){return n},n}var G=function(r){function i(n){return o(this,i),f(this,l(i).call(this,n))}return s(i,t),a(i,[{key:"render",value:function(){var t=this.props.value?this.props.value:0,r=t/(this.props.maxValue?this.props.maxValue:0)*100,o=w(t,this.props.decimals),i=this.props.color?this.props.color:d,a=e.circle(q(),i),s=e.div($()),l=e.div(W(),x,i),c=e.div(D(),m,i),u=e.span(H(),m,i),f=e.svg(B()),p=e.circle(R(),i);return n.createElement(s,null,n.createElement(f,{viewBox:"0 0 33.83098862 33.83098862"},n.createElement(p,{cx:"16.91549431",cy:"16.91549431",r:"15.91549431"}),n.createElement(a,{strokeDasharray:r+",100",cx:"16.91549431",cy:"16.91549431",r:"15.91549431"})),n.createElement(l,null,n.createElement(u,null,this.props.prefix),o,n.createElement(u,null,this.props.postfix)),n.createElement(c,null,this.props.metric))}}]),i}();export{G as CircleChart,L as LineChart};
